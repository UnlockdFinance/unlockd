# uTokens

_Implementation of the interest bearing token for the Unlockd protocol_

### _addressProvider

```solidity
contract ILendPoolAddressesProvider _addressProvider
```

### _treasury

```solidity
address _treasury
```

### _underlyingAsset

```solidity
address _underlyingAsset
```

### onlyLendPool

```solidity
modifier onlyLendPool()
```

### onlyLendPoolConfigurator

```solidity
modifier onlyLendPoolConfigurator()
```

### initialize

```solidity
function initialize(contract ILendPoolAddressesProvider addressProvider, address treasury, address underlyingAsset, uint8 uTokenDecimals, string uTokenName, string uTokenSymbol) external
```

_Initializes the uToken_

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| addressProvider | contract ILendPoolAddressesProvider | The address of the address provider where this uToken will be used |
| treasury | address | The address of the Unlockd treasury, receiving the fees on this uToken |
| underlyingAsset | address | The address of the underlying asset of this uToken |
| uTokenDecimals | uint8 |  |
| uTokenName | string |  |
| uTokenSymbol | string |  |

### burn

```solidity
function burn(address user, address receiverOfUnderlying, uint256 amount, uint256 index) external
```

_Burns uTokens from `user` and sends the equivalent amount of underlying to `receiverOfUnderlying`
- Only callable by the LendPool, as extra state updates there need to be managed_

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| user | address | The owner of the uTokens, getting them burned |
| receiverOfUnderlying | address | The address that will receive the underlying |
| amount | uint256 | The amount being burned |
| index | uint256 | The new liquidity index of the reserve |

### mint

```solidity
function mint(address user, uint256 amount, uint256 index) external returns (bool)
```

_Mints `amount` uTokens to `user`
- Only callable by the LendPool, as extra state updates there need to be managed_

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| user | address | The address receiving the minted tokens |
| amount | uint256 | The amount of tokens getting minted |
| index | uint256 | The new liquidity index of the reserve |

#### Return Values

| Name | Type | Description |
| ---- | ---- | ----------- |
| [0] | bool | `true` if the the previous balance of the user was 0 |

### mintToTreasury

```solidity
function mintToTreasury(uint256 amount, uint256 index) external
```

_Mints uTokens to the reserve treasury
- Only callable by the LendPool_

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| amount | uint256 | The amount of tokens getting minted |
| index | uint256 | The new liquidity index of the reserve |

### balanceOf

```solidity
function balanceOf(address user) public view returns (uint256)
```

_Calculates the balance of the user: principal balance + interest generated by the principal_

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| user | address | The user whose balance is calculated |

#### Return Values

| Name | Type | Description |
| ---- | ---- | ----------- |
| [0] | uint256 | The balance of the user |

### scaledBalanceOf

```solidity
function scaledBalanceOf(address user) external view returns (uint256)
```

_Returns the scaled balance of the user. The scaled balance is the sum of all the
updated stored balance divided by the reserve's liquidity index at the moment of the update_

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| user | address | The user whose balance is calculated |

#### Return Values

| Name | Type | Description |
| ---- | ---- | ----------- |
| [0] | uint256 | The scaled balance of the user |

### getScaledUserBalanceAndSupply

```solidity
function getScaledUserBalanceAndSupply(address user) external view returns (uint256, uint256)
```

_Returns the scaled balance of the user and the scaled total supply._

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| user | address | The address of the user |

#### Return Values

| Name | Type | Description |
| ---- | ---- | ----------- |
| [0] | uint256 | The scaled balance of the user |
| [1] | uint256 | The scaled balance and the scaled total supply |

### totalSupply

```solidity
function totalSupply() public view returns (uint256)
```

_calculates the total supply of the specific uToken
since the balance of every single user increases over time, the total supply
does that too._

#### Return Values

| Name | Type | Description |
| ---- | ---- | ----------- |
| [0] | uint256 | the current total supply |

### scaledTotalSupply

```solidity
function scaledTotalSupply() public view virtual returns (uint256)
```

_Returns the scaled total supply of the variable debt token. Represents sum(debt/index)_

#### Return Values

| Name | Type | Description |
| ---- | ---- | ----------- |
| [0] | uint256 | the scaled total supply |

### RESERVE_TREASURY_ADDRESS

```solidity
function RESERVE_TREASURY_ADDRESS() public view returns (address)
```

_Returns the address of the Unlockd treasury, receiving the fees on this uToken_

### UNDERLYING_ASSET_ADDRESS

```solidity
function UNDERLYING_ASSET_ADDRESS() public view returns (address)
```

_Returns the address of the underlying asset of this uToken_

### POOL

```solidity
function POOL() public view returns (contract ILendPool)
```

_Returns the address of the lending pool where this uToken is used_

### _getIncentivesController

```solidity
function _getIncentivesController() internal view returns (contract IIncentivesController)
```

_For internal usage in the logic of the parent contract IncentivizedERC20_

### _getUnderlyingAssetAddress

```solidity
function _getUnderlyingAssetAddress() internal view returns (address)
```

### getIncentivesController

```solidity
function getIncentivesController() external view returns (contract IIncentivesController)
```

_Returns the address of the incentives controller contract_

### transferUnderlyingTo

```solidity
function transferUnderlyingTo(address target, uint256 amount) external returns (uint256)
```

_Transfers the underlying asset to `target`. Used by the LendPool to transfer
assets in borrow(), withdraw() and flashLoan()_

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| target | address | The recipient of the uTokens |
| amount | uint256 | The amount getting transferred |

#### Return Values

| Name | Type | Description |
| ---- | ---- | ----------- |
| [0] | uint256 | The amount transferred |

### _getLendPool

```solidity
function _getLendPool() internal view returns (contract ILendPool)
```

### _getLendPoolConfigurator

```solidity
function _getLendPoolConfigurator() internal view returns (contract ILendPoolConfigurator)
```

### _transfer

```solidity
function _transfer(address from, address to, uint256 amount, bool validate) internal
```

_Transfers the uTokens between two users. Validates the transfer
(ie checks for valid HF after the transfer) if required_

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| from | address | The source address |
| to | address | The destination address |
| amount | uint256 | The amount getting transferred |
| validate | bool | `true` if the transfer needs to be validated |

### _transfer

```solidity
function _transfer(address from, address to, uint256 amount) internal
```

_Overrides the parent _transfer to force validated transfer() and transferFrom()_

#### Parameters

| Name | Type | Description |
| ---- | ---- | ----------- |
| from | address | The source address |
| to | address | The destination address |
| amount | uint256 | The amount getting transferred |

